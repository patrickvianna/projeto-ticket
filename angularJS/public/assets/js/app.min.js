"use strict";angular.module("myApp",["ngAnimate","ui.router","toastr","ngTouch","ui.bootstrap","lr.upload"]);
"use strict";angular.module("myApp").constant("consts",{appName:"Projeto ticket",version:"1.0",owner:"Patrick",year:"2018",site:"",apiUrl:"http://localhost:3003/api",oapiUrl:"http://localhost:3003/oapi",userKey:"_my_app_user"}).run(["$rootScope","consts",function(t,o){t.consts=o}]);
"use strict";angular.module("myApp").config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,e,i){t.state("ticketList",{url:"/ticketList",templateUrl:"template/ticket.list.html"}).state("newTicket",{url:"/newTicket",templateUrl:"template/ticket.new.html"}).state("login",{url:"/login",templateUrl:"template/login.html"}).state("ticketDetalhe",{url:"/detalhe-ticket/:idTicketRota",templateUrl:"template/ticket.detail.html"}),i.interceptors.push("handleResponseError")}]).run(["$rootScope","$http","$location","$window","auth",function(t,e,i,l,o){function a(){var t=o.getUser(),a="/auth.html",n=l.location.href.includes(a);t||n?t&&!t.isValid&&o.validateToken(t.token,function(o,r){r?(t.isValid=!0,e.defaults.headers.common.Authorization=t.token,n?l.location.href="/":i.path("/ticketList")):l.location.href=a}):l.location.href=a}a(),t.$on("$locationChangeStart",function(){return a()})}]);
"use strict";angular.module("myApp").component("detailModal",{template:'<div class="modal-header">\n        <button type="button" ng-click="$ctrl.handleClose()" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">×</span></button>\n        <h2 class="modal-title">Detalhes do ticket</h2>\n      </div>\n    \x3c!-- HEADER --\x3e\n    \n    <div class="jumbotron margem-detail">\n        \x3c!--button type="button" class="close" data-dismiss="modal" aria-label="Close">\n        <span aria-hidden="true">×</span></button--\x3e\n        <div class="modal-body">\n            \n            <div class="panel panel-info">\n                <div class="panel-heading">\n                    <h2><b>{{ ::$ctrl.tarefa.subject }}</b></h2>\n                    <div class="row">\n                        <div class="col-xs-6 col-md-3">\n                            <h3><b>Ticket ID:</b> {{ ::$ctrl.tarefa.id }}</h3>\n                        </div>\n                        <div class="col-xs-6 col-md-6">\n                            <h3><b>Projeto:</b> {{ ::$ctrl.tarefa.project.name }}</h3>\n                        </div>\n                    </div>\n                    <h4><span class="glyphicon glyphicon-fire"></span> <b>Autor:</b> {{ ::$ctrl.tarefa.author.name }}</h4>\n    \n                    \n                </div>\n                <div class="panel-body">\n                        <div class="row">\n                                <div class="col-xs-6 col-md-3">\n                                    <h4> <b>Tipo:</b> {{ ::$ctrl.tarefa.tracker.name }} </h4>\n                                </div>\n                                <div class="col-xs-6 col-md-3">\n                                    <h4> <b>Status:</b> {{ ::$ctrl.tarefa.status.name }} </h4>\n                                </div>\n                                <div class="col-xs-6 col-md-4">\n                                    <h4> <b>Prioridade:</b> {{ ::$ctrl.tarefa.priority.name }} </h4>\n                                </div>\n                                <div class="col-xs-6 col-md-2">\n                                    <h4> {{ ::$ctrl.tarefa.done_ratio }} <b>%</b> </h4>\n                                </div>\n                            </div>\n                            \x3c!--div class="row">\n                                <div class="col-xs-4 col-md-3">\n                                    <h4> <b>%</b> {{ ::$ctrl.tarefa.done_ratio }} </h4>\n                                </div>\n                                <div class="col-xs-4 col-md-3">\n                                    <h4> <b>Estimado:</b> {{ ::$ctrl.tarefa.spent_hours }} </h4>\n                                </div>\n                                <div class="col-xs-4 col-md-3">\n                                    <h4> <b>Gasto:</b> {{ ::$ctrl.tarefa.total_spent_hours }} </h4>\n                                </div>\n                            </div--\x3e\n                    </br>\n                    <pre>{{ ::$ctrl.tarefa.description }}</pre>\n                    <hr>\n                    <div class="row">\n                        <h5>\n                            <div class="col-md-3"> \n                                <b>Postado em:</b> {{ ::$ctrl.tarefa.start_date | date:\'dd/MM/yyyy\' }} \n                            </div>\n                            <div class="col-md-4"> \n                                <div ng-if="$ctrl.tarefa.due_date != null" > <b>Estimado para:</b> {{ ::$ctrl.tarefa.due_date | date:\'dd/MM/yyyy\' }} </div> \n                                <div ng-if="$ctrl.tarefa.due_date == null" > <b>Estimado para:</b> -- </div> \n                            </div\n                        </h5>\n                    </div>\n                </div>\n            </div>\n    </div>\n    </div>\n    \n    \x3c!-- FOOTER --\x3e\n    \x3c!--div class="modal-footer">\n        <button type="button" ng-click="$ctrl.handleClose()" class="btn btn-default pull-left" data-dismiss="modal">Close</button>\n        <button type="button" class="btn btn-primary">Save changes</button>\n      </div--\x3e',bindings:{$close:"&",$dismiss:"&",modalData:"<",tarefa:"<"},controller:["$http","consts",function(a,n){var t=this;t.tarefa={},t.handleClose=function(){console.info("in handle close"),t.$close({result:t.modalData})},console.log(t.idTicket),console.log(t.modalData);t.handleDismiss=function(){console.info("in handle dismiss"),t.$dismiss({reason:"cancel"})}}]});
"use strict";angular.module("myApp").component("myModal",{template:'<div class="modal-body"><div>{{$ctrl.greeting}}</div> \n    <label>Name To Edit</label> <input ng-model="$ctrl.modalData.name"><br>\n    <label>Value To Edit</label> <input ng-model="$ctrl.modalData.value"><br>\n    <button class="btn btn-warning" type="button" ng-click="$ctrl.handleClose()">Close Modal</button>\n    <button class="btn btn-warning" type="button" ng-click="$ctrl.handleDismiss()">Dimiss Modal</button>\n    </div>',bindings:{$close:"&",$dismiss:"&",greeting:"<",modalData:"<"},controller:[function(){var n=this;n.handleClose=function(){console.info("in handle close"),n.$close({result:n.modalData})},n.handleDismiss=function(){console.info("in handle dismiss"),n.$dismiss({reason:"cancel"})}}]});
"use strict";angular.module("myApp").component("newModal",{template:'<div class="modal-header">\n        <button type="button" ng-click="$ctrl.handleClose()" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">×</span></button>\n        <h2 class="modal-title">Novo ticket</h2>\n      </div>\n    \x3c!-- HEADER --\x3e\n    \n    \x3c!--div class="jumbotron">\n    <div class=" row">\n    <div class="col-xs-10 col-xs-offset-1 col-md-10 col-md-offset-1 "--\x3e\n    <div class="jumbotron ">\t\n     \n        <form name="ticketForm">\n            <h2>Insira um Ticket</h2>\n            <input class="form-control" type="text" ng-model="$ctrl.tarefa.titulo" name="title" placeholder="Título" ng-required="true" ng-minlength="10" ng-maxlength="50"required/>\n            <div class="row">\n                <div class="col-xs-12 col-md-4">\n                    Tipo: \n                    <select class="form-control" name="mySelectTipo" id="mySelectTipo"\n                            ng-options="option.name for option in $ctrl.tipo.lista track by option.id"\n                            ng-model="$ctrl.tipo.selectedOption"\n                            required>\n                    </select>\n                </div>\n                <div class="col-xs-12 col-md-4">\n                    Severidade: \n                    <select class="form-control" name="repeatSelect" id="repeatSelect" ng-model="$ctrl.severidade.idSeveridade" ng-required="true" required>\n                        <option ng-repeat="option in $ctrl.severidade.availableOptions" value="{{option.model}}">{{  option.severidade  }}</option>\n                    </select>\n                </div>\n                <div class="col-xs-12 col-md-4">\n                    Projeto: \n                    <select class="form-control" name="mySelect" id="mySelect"\n                            ng-options="option.name for option in $ctrl.projetos.lista track by option.id"\n                            ng-model="$ctrl.projetos.selectedOption"\n                            required>\n                    </select>\n                </div>\n            </div>\t\n        </form>\n        <textarea class="form-control" ng-model="$ctrl.tarefa.descricao" name="Descricao" form="contatoForm" placeholder="Descrição" maxlength="500" required></textarea>\n     \n        <button class="btn btn-primary btn-block" ng-click="$ctrl.setTickets()" >Adicionar Ticket</button> \x3c!-- ng-disabled="!contatoForm.$valid"--\x3e\n    \n    \x3c!--/div>\n    </div>\n    </div--\x3e',bindings:{$close:"&",$dismiss:"&",projetos:"<"},controller:["$http","consts","Msg",function(e,o,t){var i=this;i.severidade={idSeveridade:null,availableOptions:[{model:1,severidade:"Baixa"},{model:2,severidade:"Normal"},{model:3,severidade:"Alta"},{model:4,severidade:"Urgente"},{model:5,severidade:"Imediata"}]},i.tipo={lista:[],selectedOption:{id:"",name:""}},i.tarefa={idUser:"",titulo:"",descricao:"",tipo:"",prioridade:"",projeto:""},i.setTickets=function(){console.log(i.tarefa),null!=i.tarefa.titulo&&""!=i.tarefa.titulo&&" "!=i.tarefa.titulo?null!=i.severidade.idSeveridade&&""!=i.severidade.idSeveridade&&" "!=i.severidade.idSeveridade?null!=i.projetos.selectedOption.id&&""!=i.projetos.selectedOption.id&&" "!=i.projetos.selectedOption.id?null!=i.tipo.selectedOption.id&&""!=i.tipo.selectedOption.id&&" "!=i.tipo.selectedOption.id?null!=i.tarefa.descricao&&""!=i.tarefa.descricao&&" "!=i.tarefa.descricao?(i.tarefa.tipo=i.tipo.idTipo,i.tarefa.prioridade=i.severidade.idSeveridade,i.tarefa.projeto=i.projetos.selectedOption.id,i.tarefa.idUser=JSON.parse(localStorage.getItem(o.userKey)).id,e.post(o.apiUrl+"/setTickets",i.tarefa).then(function(e){console.log(e),i.$dismiss({reason:"success"})}).catch(function(e){console.log(e),t.addError("Ops, houve algo de errado")})):t.addError("Campo descricao não pode ser vazio","Campo obrigatório"):t.addError("Campo tipo não pode ser vazio","Campo obrigatório"):t.addError("Campo projeto não pode ser vazio","Campo obrigatório"):t.addError("Campo severidade não pode ser vazio","Campo obrigatório"):t.addError("Campo título não pode ser vazio","Campo obrigatório")};e.post(o.apiUrl+"/getTipo",JSON.parse(localStorage.getItem(o.userKey))).then(function(e){i.tipo.lista=e.data}).catch(function(e){t.addError("Não foi possível carregar as informações")}),i.handleClose=function(){console.info("in handle close"),i.$close({result:i.modalData})},i.handleDismiss=function(){console.info("in handle dismiss"),i.$dismiss({reason:"cancel"})}}]});
"use strict";angular.module("myApp").component("paginator",{bindings:{url:"@",total:"@"},controller:["$location",function(t){this.$onInit=function(){var n=parseInt(this.total)||1;this.totalArray=Array(n).fill(0).map(function(t,n){return n+1});for(var r=[],a=startPage;a<=endPage;a++)r.push(a);this.current=parseInt(t.search().page)||1,this.needPagination=this.total>1,this.hasPrev=this.current>1,this.hasNext=this.current<this.total,this.isCurrent=function(t){return this.current==t}}}],template:'\n       <ul ng-if="$ctrl.needPagination"\n         class="pagination pagination-sm no-margin pull-right">\n         <li ng-if="$ctrl.hasPrev">\n           <a href="{{ $ctrl.url }}?page={{ $ctrl.current - 1}}">«</a>\n         </li>\n         <li ng-class="{active: $ctrl.isCurrent(i)}"\n           ng-repeat="i in $ctrl.totalArray">\n           <a href="{{ $ctrl.url }}?page={{i}}">{{i}}</a>\n         </li>\n         <li ng-if="$ctrl.hasNext">\n           <a href="{{ $ctrl.url }}?page={{ $ctrl.current + 1}}">»</a>\n         </li>\n       </ul>\n    '});
"use strict";angular.module("myApp").directive("uiAccordion",function(){return{templateUrl:"template/accordionVm.html",scope:{ticketObject:"="},require:"^uiAccordions",link:function(e,i,c,n){n.registerAccordion(e),e.open=function(){n.closeAll(),e.isOpened=!e.isOpened}}}});
"use strict";!function(){angular.module("myApp").controller("LoginCtrl",["$http","Msg","Url","auth","$location",function(o,t,n,r,u){var e=this;e.loginMode=!0,e.user={login:"",senha:""},e.logar=function(){r.login(e.user,function(o){o?t.addError("Erro ao logar"):(u.path("/ticketList"),t.addSucess("Bem-vindo","Logado com sucesso!"))})},e.logout=function(){r.logout(function(){return u.path("/")})},e.getUser=function(){return r.getUser()}}])}();
"use strict";!function(){angular.module("myApp").controller("NewTicket",["$scope","$http","Ticket","consts","Msg","$state",function(e,o,t,a,i,d){var r=this;r.severidade={idSeveridade:null,availableOptions:[{model:1,severidade:"Baixa"},{model:2,severidade:"Normal"},{model:3,severidade:"Alta"},{model:4,severidade:"Urgente"},{model:5,severidade:"Imediata"}]},r.tipo={idTipo:null,availableOptions:[{model:1,tipo:"Bug"},{model:2,tipo:"Funcionalidade"},{model:3,tipo:"Suporte"}]},r.projetos={lista:[],selectedOption:{id:"",name:""}},r.tarefa={idUser:"",titulo:"",descricao:"",tipo:"",prioridade:"",projeto:""},r.setTickets=function(){r.tarefa.tipo=r.tipo.idTipo,r.tarefa.prioridade=r.severidade.idSeveridade,r.tarefa.projeto=r.projetos.selectedOption.id,r.tarefa.idUser=JSON.parse(localStorage.getItem(a.userKey)).id,o.post(a.apiUrl+"/setTickets",r.tarefa).then(function(e){console.log(e),d.go("ticketList"),i.addSucess("Criado com sucesso")}).catch(function(e){console.log(e),i.addError("Ops, houve algo de errado")})},o.post(a.apiUrl+"/getProjetos",JSON.parse(localStorage.getItem(a.userKey))).then(function(e){r.projetos.lista=e.data,r.projetos.selectedOption=e.data[0]||"",console.log(e.data)}).catch(function(e){i.addError("Não foi possível carregar os projetos")})}])}();
"use strict";!function(){angular.module("myApp").controller("TicketCtrl",["$scope","$http","$location","consts","$state","Msg","$q","$rootScope","$uibModal",function(o,t,e,a,n,s,r,l,c){var i=this;i.tickets={tarefas:""};var p={idUser:JSON.parse(localStorage.getItem(a.userKey)),init:"",max:10,project:""};i.projetos={lista:[],selectedOption:{id:"",name:""}},i.pager={atualPage:"",totalItens:"",totalPages:"",startPage:"",endPage:"",startIndex:"",endIndex:"",pages:""},i.detailTicket=function(o){c.open({template:'<detail-modal tarefa="$ctrl.tarefa" $close="$close(result)" $dismiss="$dismiss(reason)"></detail-modal>',controller:[function(){var e=this,n=o;t.post(a.apiUrl+"/getDetail",{rota:n}).then(function(o){e.tarefa=o.data.issue,console.log(e.tarefa)}).catch(function(o){console.log(o)})}],controllerAs:"$ctrl",size:"lg",resolve:{}}).result.then(function(o){console.info("I was closed, so do what I need to do myContent's controller now and result was->"),console.info(o)},function(o){console.info("I was dimissed, so do what I need to do myContent's controller now and reason was->"+o)})},i.newTicket=function(){c.open({template:'<new-modal projetos="$ctrl.projetos" $close="$close(result)" $dismiss="$dismiss(reason)"></new-modal>',controller:["projetos",function(o){this.projetos=o}],controllerAs:"$ctrl",size:"lg",resolve:{projetos:i.projetos}}).result.then(function(o){},function(o){"success"==o&&s.addSucess("Criado com sucesso"),i.getTicketProject()})},i.verTicket=function(o){n.go("ticketDetalhe",{idTicketRota:o})},i.getTicketProject=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;p.project=i.projetos.selectedOption.id,p.init=o,t.post(a.apiUrl+"/getTicketProject",p).then(function(t){i.tickets.tarefas=t.data.issues,i.pager.totalItens=t.data.total_count,i.pager=d(o,i.pager.totalItens)}).catch(function(o){s.addError("Não foi possível carregar os tickets")})};var d=function(o,t){var e=Math.ceil(t/10),a=void 0,n=void 0;e<=4?(a=1,n=e):o<=3?(a=1,n=4):o+1>=e?(a=e-3,n=e):(a=o,n=o+1);for(var s=10*(o-1),r=Math.min(s+10-1,t-1),l=[],c=a;c<=n;c++)l.push(c);return{atualPage:o,pageSize:10,totalPages:e,startPage:a,endPage:n,startIndex:s,endIndex:r,pages:l}};r(function(o,e){t.post(a.apiUrl+"/getProjetos",JSON.parse(localStorage.getItem(a.userKey))).then(function(t){i.projetos.lista=t.data,i.projetos.selectedOption=t.data[0]||"",i.projetos.lista.length<1?(s.addError("Não há projetos associados a esse usuário"),e()):o()}).catch(function(o){s.addError("Não foi possível carregar os projetos")})}).then(function(o){i.getTicketProject()})}])}(),angular.module("myApp").controller("AppCtrl",["$scope","$http","consts",function(o,t,e){o.responseData=void 0,t({method:"post",url:e.apiUrl+"/setFile",cache:!1}).then(function(t){o.uploads=t.data}),o.onGlobalSuccess=function(t){console.log("AppCtrl.onSuccess",t),o.responseData=t.data,o.uploads=o.uploads.concat(t.data.files)}}]),angular.module("myApp").controller("SimpleCtrl",["$scope","$http","consts",function(o,t,e){var a=this;a.arquivo=null;var n={arquivo:null};a.teste=function(){console.dir(a.arquivo),console.log(a.arquivo),console.log(a.myFile),console.log(o.myFile),n.arquivo=a.arquivo,t.post(e.apiUrl+"/setFile",n).then(function(o){console.log("voltou")}).catch(function(o){})}}]),angular.module("myApp").controller("AdvancedMarkupCtrl",["$scope","$http",function(o,t){o.acceptTypes="image/*,application/pdf",o.uploadData={myformdata:"hello world"},o.onUpload=function(o){console.log("AdvancedMarkupCtrl.onUpload",o)},o.onError=function(t){console.error("AdvancedMarkupCtrl.onError",t),o.responseData=t.data},o.onComplete=function(t){console.log("AdvancedMarkupCtrl.onComplete",t),o.responseData=t.data}}]);
"use strict";angular.module("myApp").service("TicketTs",function(e){});
"use strict";!function(){angular.module("myApp").controller("DetailCtrl",["$http","consts","$scope",function(o,t){var e=this,n=47;e.tarefa={},e.coment="",e.comentsLs=[];new Date;e.addComent=function(){console.log("ENTREI NO COMENTARIO");var o={descricao:e.coment,dateCreate:"12/01/2018 16:27"};e.comentsLs.push(o),e.coment="",console.log(e.comentsLs)},e.close=function(){e.$dismiss({reason:"cancel"})},o.post(t.apiUrl+"/getDetail",{rota:n}).then(function(o){e.tarefa=o.data.issue,console.log(e.tarefa)}).catch(function(o){console.log(o)})}])}();
"use strict";!function(){angular.module("myApp").factory("auth",["$http","consts",function(t,n){var o=null;function e(){return o||(o=JSON.parse(localStorage.getItem(n.userKey))),o}function a(o,e,a){t.post(n.oapiUrl+"/"+o,e).then(function(o){localStorage.setItem(n.userKey,JSON.stringify(o.data)),t.defaults.headers.common.Authorization=o.data.token,a&&a(null,o.data)}).catch(function(t){a&&(console.log(t),a(t,null))})}function u(e){o=null,localStorage.removeItem(n.userKey),t.defaults.headers.common.Authorization="",e&&e(null)}return{signup:function(t,n){a("signup",t,n)},login:function(t,n){a("login",t,n)},logout:u,getUser:e,validateToken:function(o,a){o?t.post(n.oapiUrl+"/validateToken",{token:o}).then(function(n){n.data.valid?t.defaults.headers.common.Authorization=e().token:u(),a&&a(null,n.data.valid)}).catch(function(t){a&&a(t.data.errors)}):a&&a("Token inválido.")}}}])}();
"use strict";angular.module("myApp").factory("gridSystem",[function(){return{toCssClasses:function(s){var t=s?s.split(" "):[],o="";return t[0]&&(o+="col-xs-offset-"+t[0]),t[1]&&(o+="col-xs-"+t[1]),t[2]&&(o+="col-md-offset-"+t[2]),t[3]&&(o+="col-md-"+t[3]),o}}}]);
"use strict";!function(){angular.module("myApp").factory("handleResponseError",["$q","$window","consts",function(r,e,o){return{responseError:function(n){403===n.status&&(localStorage.removeItem(o.userKey),e.location.href="/");return r.reject(n)}}}])}();
"use strict";!function(){angular.module("myApp").factory("Msg",["toastr",function(r){function n(n,o,t){n instanceof Array?n.forEach(function(n){return r[t](n,o)}):r[t](n,o)}return{addSucess:function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Sucesso";n(r,o,"success")},addError:function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Erro";n(r,o,"error")}}}])}();
"use strict";angular.module("myApp").factory("Ticket",function(){return function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.numRegistro=t,this.titulo=i,this.dtCriacao=n,this.status=u}});
"use strict";angular.module("myApp").factory("Url",function(){return{userAll:function(){return"http://redmine:81/redmine/users.json?key=683ad157ea69a8e9d8b5db20782b92fd1267e238"},projectAll:function(){return"http://redmine:81/redmine/projects.json?key=683ad157ea69a8e9d8b5db20782b92fd1267e238"},usersProject:function(e){return"http://redmine:81/redmine/projects/"+e+"/memberships.json?key=683ad157ea69a8e9d8b5db20782b92fd1267e238"},validarUsuario:function(e){return"http://redmine:81/redmine/users.json?key=683ad157ea69a8e9d8b5db20782b92fd1267e238&name="+e}}});
"use strict";angular.module("myApp").factory("User",function(){return function(t,i,s,n,a,e,h){this.id=t,this.created_on=i,this.name=s,this.fistname=n,this.lastname=a,this.login=e,this.mail=h}});